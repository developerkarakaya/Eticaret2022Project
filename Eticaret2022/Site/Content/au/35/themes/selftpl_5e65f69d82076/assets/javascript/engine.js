(function(){'use strict';window.currentRevision=window.currentRevision||new Date().getTime();var ArrayProto=Array.prototype,ObjProto=Object.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var currencySymbol='₺'
var formattedOutput=new Intl.NumberFormat('tr-TR',{style:'currency',currency:'TRY',minimumFractionDigits:2,});window.engine=window.engine||{name:'Engine',version:'1.4',config:{username:'ecerez',getUrl:'https://get.ideasoftapp.com/?url='},hasCombine:!1,combineItems:[],addedProducts:[],currentIndex:null,init:function(){if(route.group=='product'&&route.name=='detail'){engine.$.when(engine.getRemoteCombineData()).done(function(response){if(engine.hasPrimaryId(response.data)){engine.hasCombine=!0}
if(engine.hasCombine){engine.$.when(engine.getCombineProducts(response.data[engine.currentIndex])).done(function(response){engine.combineButtonHTMLManipulation()})}
engine.addToCartHTMLManipulation()});engine.setPushStateDisabled();engine.eventListeners()}},setPushStateDisabled:function(){var pushState=history.pushState;history.pushState=function(){pushState.apply(history,arguments);engine.$('body').css({'visibility':'hidden'});setTimeout(function(){if(window.location.hash.indexOf('gallery')==-1){window.location.href=window.location.pathname}},250)}},eventListeners:function(){var getParentData=function(element){return{element:engine.$(element).parents('.combine-custom-row'),index:engine.$(element).parents('.combine-custom-row').attr('data-combine-change-item-index')}}
engine.$(document).on('click','[data-action="change-combine-products"]',function(event){engine.$('html, body').animate({scrollTop:(engine.$('.change-combine-products').offset().top-50)},500);event.preventDefault()});engine.$(document).on('change','[data-action="combine-change-item-qty"]',function(){var index=getParentData(engine.$(this))['index'];engine.combineItems[index].qty=engine.$(this).val();var price=((engine.combineItems[index].hasDiscount?engine.combineItems[index].discount:engine.combineItems[index].price)*engine.combineItems[index].qty);getParentData(engine.$(this))['element'].find('[data-selector="combine-change-item-total-price"]').html(engine.convertPrice('number',price));engine.renderCombineViewItems(engine.combineItems)});engine.$(document).on('click','[data-action="combine-change-item-add-optional"]',function(){getParentData(engine.$(this))['element'].attr('data-combine-change-item-optional','false');engine.combineItems[getParentData(engine.$(this))['index']].hasOptional=!1;engine.renderCombineViewItems(engine.combineItems)});engine.$(document).on('click','[data-action="combine-change-item-remove"]',function(){var status=[];engine.$('[data-selector="combine-change-product-items"]').find('> div').each(function(){if(engine.$(this).attr('data-combine-change-item-optional')=='false'){status.push(!0)}});if(status.length>1){getParentData(engine.$(this))['element'].attr('data-combine-change-item-optional','true');engine.combineItems[getParentData(engine.$(this))['index']].hasOptional=!0;engine.renderCombineViewItems(engine.combineItems)}else{IdeaApp.plugins.notification('Paket içeriğinde en az 1 adet ürün bulunması gerekmektedir.','warning')}});engine.$(document).on('click','[data-selector="add-to-cart-engine"]',function(){engine.setAddedCardProducts();if(engine.addedProducts==''){IdeaApp.plugins.notification('Ürünü sepete ekleyebilmek için lütfen ürün seçimi yapımız.','warning')}else{var addedStoreage='(';for(var i=0;i<engine.addedProducts.length;i++){addedStoreage+=engine.addedProducts[i].title+','}
addedStoreage=addedStoreage.slice(0,-1);addedStoreage+=')';if(!engine.utils.isNull(engine.storage.get('session','combineItems'))){engine.storage.set('session','combineItems',engine.storage.get('session','combineItems')+' - '+addedStoreage)}else{engine.storage.set('session','combineItems',addedStoreage)}
engine.$('.add-to-cart-button').addClass('btn-loading');setTimeout(function(){window.location.href=engine.getAddedProducts()},650)}})},getAddedProducts:function(){var complementProducts='';for(var i=0;i<engine.addedProducts.length;i++){complementProducts+='&products['+i+'][id]='+engine.addedProducts[i].id+'&products['+i+'][amount]='+engine.addedProducts[i].qty}
return window.location.origin+'/index.php?do=catalog/quickOrder'+complementProducts},setAddedCardProducts:function(){engine.addedProducts=[];for(var i in engine.combineItems){if(!engine.combineItems[i].hasOptional){engine.addedProducts.push({'id':engine.combineItems[i].id,'qty':engine.combineItems[i].qty,'title':engine.combineItems[i].title})}}},combineButtonHTMLManipulation:function(){engine.$('.add-to-cart-default-button, .quick-order-button, .product-qty-wrapper').remove();engine.$('.combine-products').show();engine.$('.change-combine-products').show()},addToCartHTMLManipulation:function(){if(!engine.hasCombine){engine.$('.add-to-cart-engine-button').remove()}
engine.$('.product-cart-buttons').css('display','flex')},hasPrimaryId:function(data){var result=!1;for(var i in data){if(Number(data[i].primary_product_id)==pageParams.product.id||Number(data[i].primary_product_id)==pageParams.product.parentId){engine.currentIndex=i;result=!0;break}}
return result},getRemoteCombineData:function(){return engine.$.get('//combine.ideasoftapp.com/get.php?username='+engine.config.username)},convertPrice:function(type,value){if(type=='string'){return parseFloat(value.match(/(?!0\.00)\d{1,3}(.\d{3})*(\,\d\d)?/)[0].replace(/[*.]/g,'').replace(/[*,]/g,'.'))}else if(type=='number'){return formattedOutput.format(value)}},getCombineProducts:function(data){var groups=data.group;var stringUrls='';for(var i in groups){stringUrls+=groups[i].url+','}
stringUrls=stringUrls.substring(0,stringUrls.length-1);engine.$.get('https://get.ideasoftapp.com/?cache=true&multiple=true&url='+stringUrls).done(function(response){engine.combineItems=[];for(var i in response.data){var responseHTML=engine.$(engine.utils.parseHTML(response.data[i]));if(engine.$(responseHTML).find('[class="current-page-product-detail"]').length==0){break}
var discount='',hasDiscount=!1;if(responseHTML.find('.product-price-new').length!=0){discount=engine.convertPrice('string',engine.utils.trim(responseHTML.find('.product-price-new').text()));hasDiscount=!0}
var stockAmount=Number(responseHTML.find('[data-stockamount]').attr('data-stockamount'));if(stockAmount!=0){engine.combineItems.push({'id':responseHTML.find('[data-selector="product-id"]').val(),'title':engine.utils.trim(responseHTML.find('.product-title h1').text()),'qty':data.group[i].qty,'amount':responseHTML.find('[data-stockamount]').attr('data-stockamount'),'image':responseHTML.find('#product-primary-image').find('img').attr('src'),'hasOptional':data.group[i].optional,'hasDiscount':hasDiscount,'discount':discount,'price':engine.convertPrice('string',engine.utils.trim(responseHTML.find('.product-price-old').text())),'link':data.group[i].url})}}
if(engine.combineItems!=''){engine.renderCombineViewItems(engine.combineItems);engine.renderCombineChangeItems(engine.combineItems)}})},setTotalPrice:function(){var price=0;engine.$('[data-selector="combine-product-items"] > .combine-custom-row').not('[data-combine-item-optional="true"]').each(function(){price+=(parseFloat(engine.$(this).attr('data-combine-item-price'))*Number(engine.$(this).attr('data-combine-item-qty')))});engine.$('[data-selector="combine-total-price"]').html(engine.convertPrice('number',price))},renderCombineViewItems:function(items){engine.$('[data-selector="combine-product-items"]').html('');for(var i in items){var price=(items[i].hasDiscount?items[i].discount:items[i].price);engine.$('[data-selector="combine-product-items"]').append('<div class="row combine-custom-row" data-combine-item-index="'+i+'" data-combine-item-price="'+price+'" data-combine-item-qty="'+items[i].qty+'" data-combine-item-id="'+items[i].id+'" data-combine-item-optional="'+(items[i].hasOptional?'true':'false')+'">'+'<div class="col-8 col-md-8">'+items[i].title+'</div>'+'<div class="col-4 col-md-4 text-right">'+'<span data-selector="combine-products-item-quantity">'+items[i].qty+'</span> x <span data-selector="combine-products-item-price">'+engine.convertPrice('number',price)+'</span>'+'</div>'+'</div>')}
engine.setTotalPrice()},renderCombineChangeItems:function(items){for(var i in items){var price=(items[i].hasDiscount?items[i].discount:items[i].price);engine.$('[data-selector="combine-change-product-items"]').append('<div class="row combine-custom-row" data-combine-change-item-index="'+i+'" data-combine-change-item-price="'+price+'" data-combine-change-item-qty="'+items[i].qty+'" data-combine-change-item-id="'+items[i].id+'" data-combine-change-item-optional="'+(items[i].hasOptional?'true':'false')+'">'+'<div class="col-md-4 col-3 align-items-center justify-left">'+items[i].title+'</div>'+'<div class="col-md-2 col-2 combine-mobile-hide text-left align-items-center">'+'<span data-selector="combine-change-item-unit-price">'+engine.convertPrice('number',price)+'</span>'+'</div>'+'<div class="col-md-2 col-3 text-left align-items-center">'+'<div class="input-group"><select class="form-control" data-selector="combine-change-item-qty" data-action="combine-change-item-qty"></select><a href="javascript:void(0);" data-selector="combine-change-item-add-optional" data-action="combine-change-item-add-optional">Pakete ekle</a></div>'+'</div>'+'<div class="col-md-2 col-3 text-left align-items-center">'+'<span data-selector="combine-change-item-total-price">'+engine.convertPrice('number',(price*Number(items[i].qty)))+'</span>'+'</div>'+'<div class="col-md-2 col-3 text-left align-items-center">'+'<span class="remove" data-selector="combine-change-item-remove" data-action="combine-change-item-remove">-</span>'+'</div>'+'</div>');for(var j=1;j<11;j++){var selectBox=engine.$('[data-combine-change-item-index]').eq(i).find('select');if(j<=Number(items[i].amount)){selectBox.append('<option value="'+j+'" '+(Number(items[i].qty)===j?'selected':'')+'>'+j+'</option>')}}}},ready:function(callback,delay){if(engine.utils.isUndefined(delay)){delay=30}
var DOMLoadTimer=setInterval(function(){if(document.readyState=='complete'){clearInterval(DOMLoadTimer);if(callback&&engine.utils.isFunction(callback)){callback()}}},delay)},storage:{storageCache:{},makeFormat:function(value){var formatted=value;try{formatted=JSON.parse(value)}catch(e){}
return formatted},readLocalObj:function(type,namespace,setValue,modifier){if(engine.utils.isObject(setValue)){setValue=JSON.stringify(setValue)}
if(engine.utils.isUndefined(modifier)){modifier=!1}
var storage=window[type=='session'?'sessionStorage':'localStorage'],valueArray=namespace.split('.'),valueArrayLength=valueArray.length,currentLevel;if(!engine.utils.hasStorage()){currentLevel=this.storageCache}else{currentLevel=window[type=='session'?'sessionStorage':'localStorage']}
var rootKey=valueArray[0],objectCopy={},isSetMode=!1;if(engine.utils.isDefined(setValue)){isSetMode=!0}
for(var i=0;i<valueArrayLength;i++){var key=valueArray[i];if(engine.utils.isUndefined(currentLevel)||!engine.utils.isObject(currentLevel)){return null}
if(isSetMode&&i===valueArrayLength-1){if(modifier){var r=this.makeFormat(currentLevel[key]);r[modifier].apply(r,JSON.parse(setValue));setValue=r}
currentLevel[key]=setValue}
if(!(engine.utils.isObject(currentLevel)&&key in currentLevel)){if(i!==valueArrayLength-1){currentLevel[key]={}}else{currentLevel[key]=null}}
currentLevel=this.makeFormat(currentLevel[key]);if(i===0){objectCopy=currentLevel}}
if(isSetMode){if(!engine.utils.hasStorage()){this.storageCache[rootKey]=JSON.stringify(objectCopy)}else{storage[rootKey]=JSON.stringify(objectCopy)}}
return currentLevel},set:function(type,namespace,value,modifier){var fetchPath=this.readLocalObj(type,namespace,value,modifier);return fetchPath},get:function(type,namespace){var fetchPath;if(namespace){fetchPath=this.readLocalObj(type,namespace)}else{if(!engine.utils.hasStorage()){fetchPath=this.storageCache}else{fetchPath=window[type=='session'?'sessionStorage':'localStorage']}}
return fetchPath},getUsedSpace:function(type,optKey){var allocatedMemory=0,storage=engine.utils.hasStorage()?window[type=='session'?'sessionStorage':'localStorage']:!1,key;if(!storage){return allocatedMemory}
for(key in storage){if(storage.hasOwnProperty(key)&&(!optKey||optKey===key)){allocatedMemory+=(storage[key].length*2)/1024/1024}}
return parseFloat(allocatedMemory.toFixed(2))},clear:function(type,namespace){var storage=window[type=='session'?'sessionStorage':'localStorage'],valueArray=((engine.utils.isDefined(namespace))?namespace.split('.'):'');if(engine.utils.isDefined(valueArray[1])){if(engine.utils.isNull(this.storageCache)){return}
var objectCopy;if(!engine.utils.hasStorage()){objectCopy=JSON.parse(this.storageCache[valueArray[0]])}else{objectCopy=JSON.parse(storage[valueArray[0]])}
delete objectCopy[valueArray[1]];if(!engine.utils.hasStorage()){this.storageCache[valueArray[0]]=JSON.stringify(objectCopy)}else{storage[valueArray[0]]=JSON.stringify(objectCopy)}}else{if(engine.utils.isDefined(namespace)){if(!engine.utils.hasStorage()){delete this.storageCache[namespace]}else{storage.removeItem(namespace)}}else{if(!engine.utils.hasStorage()){this.storageCache={}}else{storage.clear()}}}
return this}},cookie:{read:function read(name){var match=document.cookie.match(new RegExp('(^|;\\s*)('+name+')=([^;]*)'));return(match?decodeURIComponent(match[3]):null)},write:function write(name,value,expires,path,domain,secure){var cookie=[];cookie.push(name+'='+encodeURIComponent(value));if(engine.utils.isNumber(expires)){var date=new Date();date.setTime(date.getTime()+expires*24*60*60*1000);cookie.push('expires='+date.toGMTString())}
if(engine.utils.isString(path)){cookie.push('path='+path)}
if(engine.utils.isString(domain)){cookie.push('domain='+domain)}
if(secure===!0){cookie.push('secure')}
document.cookie=cookie.join('; ')},remove:function remove(name){this.write(name,'',Date.now()-86400000)}},utils:{isMobile:function(){return(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/Opera Mini/i)||navigator.userAgent.match(/IEMobile/i))},isIpad:function(){return this.findDevice('ipad')},isWindows:function(){return this.findDevice('windows')},isWindowsPhone:function(){return this.isWindows()&&this.findDevice('phone')},isAndroid:function(){return!this.isWindows()&&this.findDevice('android')},isAndroidTablet:function(){return this.isAndroid()&&!this.findDevice('mobile')},isWindowsTablet:function(){return this.isWindows()&&(this.findDevice('touch')&&!this.isWindowsPhone())},isFxos:function(){return(this.findDevice('(mobile;')||this.findDevice('(tablet;'))&&this.findDevice('; rv:')},isCriOs:function(){return!navigator.userAgent.match('CriOS')},isFxosTablet:function(){return this.isFxos()&&this.findDevice('tablet')},isTablet:function(){return this.isIpad()||this.isAndroidTablet()||this.isWindowsTablet()||this.isFxosTablet()},findDevice:function(needle){return window.navigator.userAgent.toLowerCase().indexOf(needle)!==-1},isEmpty:function(value){return(!value||0===value.length)},isEmptyObject:function(value){var name;for(name in value){return!1}
return!0},isFunction:function(value){return typeof value==='function'},isObject:function(value){return value!==null&&typeof value==='object'},isArray:function(value){return Object.prototype.toString.call(value)=='[object Array]'},isString:function(value){return typeof(value)==='string'},isNumber:function(value){return typeof value==='number'},isNormalInteger:function(str){var n=Math.floor(Number(str));return n!==Infinity&&String(n)===str&&n>=0},isUndefined:function(value){return typeof value==='undefined'},isDefined:function(value){return typeof value!=='undefined'},isNull:function(value){return value===null},isBoolean:function(value){return typeof value==='boolean'},isRegExp:function(value){return Object.prototype.toString.call(value)=='[object RegExp]'},isUrl:function(str){var regexp=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/
return regexp.test(str)},isElement:function(node){return!!(node&&(node.nodeName||(node.prop&&node.attr&&node.find)))},isHandlebarsSpecific:function(value){return(value&&(value.fn!=null))||(value&&(value.hash!=null))},safeString:function(str){if(this.isDefined(engine.handlebars.Handlebars)){return new engine.handlebars.Handlebars.SafeString(str)}else{console.error('engine ~ Handlebars is undefined')}},result:function(value){if(this.isFunction(value)){return value()}else{return value}},verify:function(name,fnArg,argTypes){var arg,i,_i,msg,len,results;if(argTypes==null){argTypes=[]}
fnArg=Array.prototype.slice.apply(fnArg).slice(0,argTypes.length);results=[];for(i=_i=0,len=fnArg.length;_i<len;i=++_i){arg=fnArg[i];msg=' + name +  requires '+argTypes.length+' arguments '+argTypes.join(', ')+'.';if(argTypes[i].indexOf('safe:')>-1){if(engine.utils.isHandlebarsSpecific(arg)){results.push(engine.utils.err(msg))}else{results.push(void 0)}}else{if(this.isUndefined(arg)){results.push(this.err(msg))}else{results.push(void 0)}}}
return results},err:function(msg){throw new Error(msg)},addDots:function(str){return str.replace(/\//g,'.')},addSlashes:function(str){return str.replace(/\./g,'/')},getUrlParameters:function(url){url=url||window.location.href;var vars={};var hashes=url.slice(url.indexOf('#')+1).split('?');if(hashes.length>1){vars.state=hashes[0];hashes=hashes[1].split('&')}else{hashes=hashes[0].split('&')}
for(var i=0;i<hashes.length;i++){var hash=hashes[i].split('=');if(hash.length>1){vars[hash[0]]=hash[1]}else{vars[hash[0]]=null}}
return vars},getQueryString:function(field,url){var href=url?url:window.location.href;var reg=new RegExp('[?&]'+field+'=([^&#]*)','i');var string=reg.exec(href);return string?string[1]:null},hasStorage:function(){var uid=new Date;var storage;var result;try{(storage=window.localStorage).setItem(uid,uid);result=storage.getItem(uid)==uid;storage.removeItem(uid);return result&&storage}catch(exception){}},forEach:function(object,callback,args){var value,i=0,length=object.length;if(args){if(this.isArray(object)){for(;i<length;i++){value=callback.apply(object[i],args);if(value===!1){break}}}else{for(i in object){value=callback.apply(object[i],args);if(value===!1){break}}}}else{if(this.isArray(object)){for(;i<length;i++){value=callback.call(object[i],i,object[i]);if(value===!1){break}}}else{for(i in object){value=callback.call(object[i],i,object[i]);if(value===!1){break}}}}
return object},now:function(){return new Date().getTime()},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}},throttle:function(fn,threshhold,scope){threshhold||(threshhold=250);var last,deferTimer;return function(){var context=scope||this;var now=+new Date,args=arguments;if(last&&now<last+threshhold){clearTimeout(deferTimer);deferTimer=setTimeout(function(){last=now;fn.apply(context,args)},threshhold)}else{last=now;fn.apply(context,args)}}},wait:function(callback,hold,scope){scope=scope||this;return window.setTimeout(function(){callback.apply(scope,arguments)},hold)},serialize:function(object){var str=[];for(var i in object)
if(object.hasOwnProperty(i)){str.push(encodeURIComponent(i)+"="+encodeURIComponent(object[i]))}
return str.join('&')},serializeJSON:function(form){var options={};var formToArray=form.serializeArray();engine.$.each(formToArray,function(){if(options[this.name]){if(!options[this.name].push){options[this.name]=[options[this.name]]}
options[this.name].push(this.value||'')}else{options[this.name]=this.value||''}});return options},size:function(obj,ownPropsOnly){var count=0,key;if(isArray(obj)||isString(obj)){return obj.length}else if(isObject(obj)){for(key in obj)
if(!ownPropsOnly||obj.hasOwnProperty(key)){count++}}
return count},find:function(find,str){return new RegExp(find,'g').test(str)},has:function(object,key){return Object.prototype.hasOwnProperty.call(object,key)},parseBoolean:function(value){if(this.isBoolean(value)){return value}
switch(value.toLowerCase()){case 'true':case 'yes':case '1':return!0;case 'false':case 'no':case '0':case null:return!1;default:return Boolean(value)}},parseHTML:function(str){var html=document.createElement('html');html.innerHTML=str;return html},convertUrl:function(value){value=value.replace(/&amp;/gi,"\&");value=value.replace(/&gt;/gi,"\>");value=value.replace(/&lt;/gi,"\<");value=value.replace(/&quot;/gi,"\"");value=value.replace(/&#039;/gi,"\'");return value},escape:function(value){var chars={'&':'&#38;','<':'&#60;','>':'&#62;',' ':'&nbsp;',"'":'&#39;','"':'&#34;','\n':'<br />'};value=value.replace(/[&<> '"\n]/g,function(i){if(i in chars){return chars[i]}
return!1});return value},trim:function(value){return value.toString().replace(/^\s+|\s+$/g,'')},decode:function(value){return engine.$('<div />').html(value).text()},extend:function(destination,source){for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){destination[key]=source[key]}}
return destination},objectLength:function(value){var i=0;for(var j in value){if(this.has(value,j)){i++}}
return i},objectEquals:function(first,second){return JSON.stringify(first)===JSON.stringify(second)},arrayEquals:function(first,second){if(!second){return!1}
if(first.length!=second.length){return!1}
for(var i=0,l=first.length;i<l;i++){if(first[i]instanceof Array&&second[i]instanceof Array){if(!first[i].equals(second[i]))return!1}else if(first[i]!=second[i]){return!1}}
return!0},arrayDiff:function(first,second){var a=[],diff=[];for(var i=0;i<first.length;i++){a[first[i]]=!0}
for(var i=0;i<second.length;i++){if(a[second[i]])delete a[second[i]];else a[second[i]]=!0}
for(var k in a){diff.push(k)}
return diff},arrayRemove:function(array,value){for(var i in array){if(array[i]==value){array.splice(i,1);break}}
return array},arrayIndexOf:function(array,value){if(array.indexOf){return array.indexOf(value)}else{var n=array.length;while(n--){if(array[n]===value){return n}}
return-1}},removeArrayItemByIndex:function(array,index){if(index>-1){return array.splice(index,1)}}}}
function bindJQuery(){if(!window.jQuery){throw 'Engine: jQuery not found';return}
engine.$=$}
bindJQuery();engine.init()}())